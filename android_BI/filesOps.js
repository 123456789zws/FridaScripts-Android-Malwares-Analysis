//Interceptor.attach(Module.findExportByName(null, "open"), {});
//Interceptor.attach(Module.findExportByName(null, "creat"), {});
var O_CREAT = 0x0200; // Define the O_CREAT flag
var O_WRONLY = 0x0001; // Define the O_WRONLY flag
var O_RDWR = 0x0002;   // Define the O_RDWR flag

var counts = [];

Interceptor.attach(Module.findExportByName(null, "open"), {
    onEnter: function (args) {
        var path = Memory.readUtf8String(args[0]);
        var flags = args[1].toInt32();
        // Check if file is being opened for writing or creation
        if (flags & O_CREAT || flags & O_WRONLY || flags & O_RDWR) {
            //console.log("[New File Opened]: " + path);
            counts.push(path);
        }
    }
});

Interceptor.attach(Module.findExportByName(null, "creat"), {
    onEnter: function (args) {
        var path = Memory.readUtf8String(args[0]);
        //console.log("[New File Created]: " + path);d
        counts.push(path);
    }
});


function sendToPython(){
    send(counts);
    }  
setInterval(sendToPython, 5000);
var classes = [];
Java.perform(function () {
    // Intercept Class Loaders
    var classLoader = Java.use("dalvik.system.BaseDexClassLoader");
    //var classLoader = Java.use("java.lang.ClassLoader");
    classLoader.loadClass.overload('java.lang.String', 'boolean').implementation = function (name, resolve) {
      //console.log("[ClassLoader] Loading class: " + name);
      classes.push(name);
      return this.loadClass(name, resolve);
    };

    classLoader.loadClass.overload('java.lang.String').implementation = function (name) {
      //console.log("[ClassLoader] Loading class: " + name);
      classes.push(name);
      return this.loadClass(name);
    };
});

function sendToPython(){
  send(classes);
}

setInterval(sendToPython, 5000);
